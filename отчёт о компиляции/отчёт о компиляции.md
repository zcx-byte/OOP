## Отчёт о компилировании программы в PowerShell

### Установка MinGW-w64

Чтобы компилировать C++ программы в Windows с помощью командной строки, необходимо установить компилятор `g++`. Одним из наиболее доступных и распространённых решений является **MinGW-w64** — современная версия MinGW, поддерживающая 64-битные приложения и последние стандарты языка C++. Ниже приведён пошаговый процесс установки.

#### Шаг 1: Скачивание MinGW-w64

1. Перейдите на официальный ГитХаб MinGW-w64:  
   [https://github.com/niXman/mingw-builds-binaries/releases](https://github.com/niXman/mingw-builds-binaries/releases)


2. Так же можете скачать из SourceForge:  
   [https://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/](https://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/)
   
   Однако тут не актуальные версии, могут быть проблемы.

3. Выберите последнюю стабильную версию (например, `15.2.0`).

   Пример имени файла:
   ```
   x86_64-15.2.0-release-mcf-seh-ucrt-rt_v13-rev0.7z
   ```

5. Скачайте архив и распакуйте его с помощью 7-Zip или WinRAR в удобное место на диске, например:
   ```
   C:\mingw64
   ```

#### Шаг 2: Добавление пути к компилятору `g++` в переменную среды `Path` через свойства системы

После установки компилятора необходимо добавить путь к исполняемым файлам в системную переменную среды `Path`, чтобы можно было запускать `g++` из любого места в консоли.

##### Шаги:

1. Нажмите **Пуск** и введите в поиске:  
   **"переменные среды"**  
   (или "environment variables").

2. В результатах выберите:  
   **"Изменение переменных среды"** или **"Переменные среды"**.

3. Откроется окно **"Свойства системы"**.  
   Внизу окна нажмите кнопку **"Переменные среды"**.

![Свойства -> "Переменные среды"](image.png)
   
4. В разделе **"Системные переменные"** найдите строку **`Path`** и нажмите на неё **"Изменить"**.

![Переменные среды](image-1.png)

5. В открывшемся окне нажмите **"Добавить"** и укажите полный путь к папке `bin` внутри установленного каталога MinGW-w64:
   ```
   C:\mingw64\bin
   ```

6. Нажмите **"ОК"** во всех окнах, чтобы сохранить изменения.

7. Перезапустите PowerShell или командную строку, чтобы изменения вступили в силу.

8. Проверьте установку:

```powershell
g++ --version
```

Если команда выводит информацию о версии G++ — установка прошла успешно.

### 2. Основные команды и приёмы работы в PowerShell

Для эффективной работы в консоли необходимо знать базовые команды:

- **`cd <путь>`** — переход в указанную директорию.  
  Пример: `cd C:\projects\quadratic`

- **`cd ..`** — переход на уровень выше.

- **`cd \`** — переход в корневую директорию текущего диска.

- **`ls`** или **`dir`** — отображение содержимого текущей папки.  
  Команда `ls` является алиасом для `Get-ChildItem`.

- **`pwd`** — вывод полного пути к текущей директории.

- **Автодополнение с помощью клавиши Tab** — при вводе части имени файла или папки нажмите `Tab`, чтобы система автоматически дополнила имя. При наличии нескольких совпадений повторное нажатие переключает варианты.

- **Стрелка вверх (↑)** — позволяет просматривать историю ранее введённых команд. Удобно для повторного запуска `g++` или программы.

- **`Ctrl+C`** — прерывание выполнения текущей программы.

---

### 3. Процесс компиляции программы

Структура проекта следующая:

```
C:\projects\quadratic\
    main.cpp
    formulas.cpp
    formulas.h
```

#### Шаг 1: Переход в рабочую директорию

```powershell
cd C:\projects\quadratic
```

#### Шаг 2: Проверка содержимого папки

```powershell
ls
```

Убедитесь, что отображаются файлы `main.cpp`, `formulas.cpp`, `formulas.h`.

#### Шаг 3: Компиляция программы

Выполните команду компиляции:

```powershell
g++ main.cpp formulas.cpp -o program.exe
```

Эта команда:
- Компилирует `main.cpp` и `formulas.cpp`.
- Объединяет объектные файлы.
- Создаёт исполняемый файл `program.exe`.

Если ошибок нет, файл `program.exe` будет создан в текущей директории.

#### Шаг 4: Запуск программы

```powershell
.\program.exe
```

В Windows для запуска исполняемого файла из текущей директории требуется указывать путь `.\`, иначе система не распознает команду.

Программа запросит ввод коэффициентов `ax`, `bx^2`, `c` и выведет результат решения квадратного уравнения.

---

### 4. Оптимизация: уменьшение размера исполняемого файла

При разработке программ, особенно для встраиваемых систем, дистрибутивов с ограниченным объёмом или просто для повышения эффективности, часто требуется уменьшить размер итогового исполняемого файла. Компилятор GCC предоставляет ряд флагов и подходов для достижения этой цели.

#### Основные флаги компиляции

```powershell
g++ -O2 -s main.cpp formulas.cpp -o program.exe
```

Разберём каждый элемент подробнее.

#### -O2 — уровень оптимизации

Флаг `-O2` включает умеренный уровень оптимизации, направленный как на повышение производительности, так и на уменьшение размера кода по сравнению с `-O0` (отсутствие оптимизации). Он активирует такие оптимизации, как:

- Удаление мёртвого кода (dead code elimination)
- Встраивание небольших функций (inlining)
- Упрощение выражений (constant folding, propagation)
- Оптимизация циклов
- Удаление избыточных вычислений

Примечание: если главная цель — минимальный размер, а не максимальная скорость, лучше использовать флаг `-Os` (optimize for size).

Пример:
```powershell
g++ -Os -s main.cpp formulas.cpp -o program.exe
```

#### -s — удаление символьной (отладочной) информации

Флаг `-s` передаёт линковщику (`ld`) опцию `--strip-all`, которая полностью удаляет из исполняемого файла:

- Таблицы символов (symbol tables)
- Отладочную информацию (debug info)
- Имена функций и переменных, не нужные для выполнения

Это может значительно уменьшить размер `.exe`-файла, особенно если в проекте много функций и глобальных переменных.

Важно: после использования `-s` вы не сможете отлаживать программу в отладчике (например, GDB), так как вся отладочная информация будет утеряна.

Альтернатива: если вы хотите сохранить отладочную информацию отдельно, можно использовать внешние инструменты:
```powershell
g++ -g -Os main.cpp formulas.cpp -o program_with_debug.exe
strip --strip-debug --strip-unneeded program_with_debug.exe -o program.exe
objcopy --only-keep-debug program_with_debug.exe program.debug
```
Таким образом, `program.exe` будет компактным, а `program.debug` — содержать отладочную информацию для последующего анализа.

---

### 5. Статические библиотеки

Статическая библиотека — это файл, содержащий **скомпилированный код**, который можно **встроить в исполняемый файл** во время сборки. В Windows такие библиотеки имеют расширение `.lib`, в Linux — `.a`.

#### Зачем они нужны?

- Ускоряют сборку проектов.
- Позволяют **разделять код** на модули.
- Упрощают **повторное использование** компонентов.

---

#### Создание статической библиотеки из `formulas.cpp`

Статическая библиотека — это архив объектных файлов, который встраивается непосредственно в исполняемый файл на этапе линковки. Это позволяет распространять программу как единый файл без дополнительных зависимостей.

##### Шаг 1: Компиляция `formulas.cpp` в объектный файл

```powershell
g++ -c formulas.cpp -o formulas.o
```

Флаг `-c` указывает компилятору остановиться после этапа компиляции и не выполнять линковку. В результате создаётся объектный файл `formulas.o`, содержащий машинный код функций из `formulas.cpp`, но без разрешения внешних ссылок.

##### Шаг 2: Создание статической библиотеки

```powershell
ar rcs libformulas.a formulas.o
```

- `ar` — утилита для работы с архивами (в данном контексте — со статическими библиотеками).
- Флаги:
  - `r` — заменить или добавить файлы в архив.
  - `c` — создать архив, если он не существует (без предупреждения).
  - `s` — создать индекс (таблицу символов), что ускоряет последующую линковку.
- `libformulas.a` — стандартное имя статической библиотеки в Unix-подобных системах и MinGW. Префикс `lib` и расширение `.a` обязательны для корректной работы с флагом `-l`.

##### Шаг 3: Компиляция и линковка с библиотекой

```powershell
g++ main.cpp -L. -lformulas -o program.exe
```

- `-L.` — указывает линковщику искать библиотеки в текущем каталоге (`.`).
- `-lformulas` — указывает использовать библиотеку с именем `libformulas.a`. Компилятор автоматически добавляет префикс `lib` и расширение `.a`.
- В результате код из `formulas.o` будет включён непосредственно в `program.exe`.

> Примечание: если в `main.cpp` используются функции из `formulas.cpp`, необходимо, чтобы соответствующие объявления (заголовочные файлы, например `formulas.h`) были доступны на этапе компиляции. В противном случае возникнет ошибка «undefined reference» или «implicit declaration».

##### Дополнительные рекомендации

- **Заголовочный файл**: рекомендуется создать файл `formulas.h`, содержащий объявления всех функций из `formulas.cpp`, и включать его в `main.cpp` с помощью `#include "formulas.h"`. Это обеспечивает корректную проверку типов и сигнатур функций.
  
- **Оптимизация при создании библиотеки**: для уменьшения итогового размера можно скомпилировать объектный файл с флагами оптимизации:
  ```powershell
  g++ -Os -c formulas.cpp -o formulas.o
  ```

- **Проверка содержимого библиотеки**: чтобы убедиться, что библиотека содержит нужные символы, можно использовать:
  ```powershell
  nm libformulas.a
  ```
  Эта команда покажет список всех символов (функций, переменных) в архиве.

- **Порядок линковки**: при использовании нескольких библиотек порядок их указания в команде линковки может иметь значение. Библиотеки, зависящие от других, следует указывать **после** тех, от которых они зависят.

---

Конечно. Вот дополненный и структурированный текст без эмодзи и избыточного оформления:

---

### 6. Использование Visual Studio (IDE)

Visual Studio — мощная интегрированная среда разработки (IDE) от Microsoft, поддерживающая разработку на C++, C#, Python и других языках. Для работы с C++ можно использовать **Visual Studio Community**, которая распространяется бесплатно и включает все необходимые инструменты для разработки настольных приложений на C++.

#### Настройка и создание проекта

1. **Установка**  
   При установке Visual Studio обязательно выберите рабочую нагрузку **Desktop development with C++** («Разработка классических приложений на C++»). Эта рабочая нагрузка включает:
   - Компилятор MSVC (Microsoft Visual C++)
   - Библиотеки времени выполнения C++
   - Отладчик
   - Инструменты сборки (MSBuild)
   - Редактор кода с поддержкой IntelliSense

2. **Создание проекта**  
   - Запустите Visual Studio.
   - Выберите **Create a new project**.
   - Выберите шаблон **Console App** (или **Empty Project**, если требуется полный контроль над структурой).
   - Укажите имя проекта и расположение на диске.

3. **Добавление файлов**  
   В обозревателе решений (Solution Explorer):
   - Щёлкните правой кнопкой мыши по проекту → **Add** → **Existing Item…**
   - Добавьте файлы: `main.cpp`, `formulas.cpp`, `formulas.h`, `quadratic_tests.cpp`.
   - Убедитесь, что заголовочный файл `formulas.h` включён в соответствующие `.cpp`-файлы с помощью директивы `#include "formulas.h"`.

4. **Компиляция и запуск**  
   - Нажмите **Ctrl+F5** для запуска без отладки или **F5** для запуска с отладчиком.
   - Visual Studio автоматически скомпилирует все файлы проекта и соберёт исполняемый файл.

#### Преимущества использования Visual Studio

- **Встроенная отладка**: пошаговое выполнение кода, точки останова (breakpoints), просмотр значений переменных, стек вызовов.
- **IntelliSense**: интеллектуальное автозавершение кода, подсказки по сигнатурам функций, навигация по определениям.
- **Интеграция с системами контроля версий**: поддержка Git прямо в интерфейсе IDE (коммиты, пуллы, ветвление и т.д.).
- **Управление проектом через графический интерфейс**: удобное добавление/удаление файлов, настройка свойств сборки (конфигурации Debug/Release), управление зависимостями.
- **Анализ кода и диагностика**: встроенные инструменты для выявления потенциальных ошибок, утечек памяти, неиспользуемых переменных.
- **Поддержка современных стандартов C++**: можно указать версию стандарта (C++17, C++20 и др.) в свойствах проекта.

#### Дополнительные возможности

- **Конфигурации сборки**: по умолчанию создаются две конфигурации — **Debug** (с отладочной информацией, без оптимизации) и **Release** (с оптимизацией, без отладочной информации). Переключение между ними осуществляется в верхней панели.
- **Настройка компилятора**: через **Project Properties** можно задать дополнительные флаги компиляции, пути к заголовочным файлам, параметры линковки и т.д.
- **Тестирование**: если используется `quadratic_tests.cpp` для модульных тестов, можно интегрировать его в проект и запускать как часть процесса сборки или настроить отдельный тестовый проект с использованием фреймворков, таких как Google Test (поддерживается через NuGet или вручную).

---

### 7. Использование Git для управления проектом

Git — система контроля версий, позволяющая отслеживать изменения в коде и работать в команде.

#### Инициализация репозитория:

```powershell
git init
git add .
git commit -m "Initial commit: quadratic calculator with formulas module"
```

#### Пример `.gitignore`:

```
# Executables
*.exe
*.out

# Build directories
build/

# Logs
*.log

# VS Code settings
.vscode/
```

---

### Заключение

В ходе работы была настроена среда для разработки на C++ в Windows: установлен компилятор MinGW-w64, настроены переменные среды и освоены основные команды PowerShell. Программа для решения квадратных уравнений была успешно скомпилирована как через командную строку, так и в среде Visual Studio.

Рассмотрены ключевые аспекты сборки:
- Базовая компиляция нескольких исходных файлов
- Оптимизация размера исполняемого файла с помощью флагов `-Os` и `-s`
- Создание и использование статических библиотек
- Альтернативные подходы к сборке через IDE

Освоение этих методов позволяет эффективно работать над проектами любой сложности, выбирая оптимальный способ сборки в зависимости от требований к размеру программы, производительности и удобству разработки.